# 필독! 개발자 온보딩 가이드

## 9장. 긴급대응 온콜 업무

> 언제 일어날지 모르는 장애에 대응하는 절차와 방안

긴급대응 업무를 처리하는 온콜 엔지니어는 계획에 없던 업무나 프로덕션 환경 이슈, 일시적인 지원 요청을 처리하는 제1 방어선이다. 운영 업무를 팀에서 분리해두면 온콜 엔지니어가 예상치 못했던 운영 이슈과 지원 업무를 담당하는 동안 팀의 나머지 인력은 개발에만 집중할 수 있다. 효율적인 온콜 엔지니어는 동료와 관리자들에게 무엇보다 소중한 자원이며 온콜 업무를 통해 관계 구축과 학습 기회를 얻어 빠르게 성장한다.

비상대기, 긴급대응, 장애 처리, 지원 등에 필요한 기본적인 지식과 스킬을 다룬다. 온콜 업무의 진행 방법에 대해 알아보고 중요한 스킬에 대해서도 살펴본다.

온콜 스킬은 모든 긴급한 상황을 대비해 미리 갖춰둬야 한다.

### 긴급한 비상상황에 대응하는 온콜 업무

온콜 개발자는 교대로 역할을 맡는다. 주기는 1~2주 정도가 보편적이다. 자격을 갖춘 개발자는 모두 이 교대 업무에 참여한다. 팀에 새로 합류했거나 필요한 스킬이 부족한 입력은 보통 몇 번 정도의 온콜 업무에 보조 역할을 맡아 업무 요령을 배운다.

보조는 주 개발자가 업무를 수행할 수 없을 경우를 대비한 백업 역할을 수행한다. 

긴급대응 온콜 업무란 주로 버그 보고, 팀이 담당하는 소프트웨어의 동작 방식이나 사용법에 대한 질문 같은 일회성 지원 요청 처리 등을 말한다. 온콜 엔지니어는 이와 같은 요청을 분류해서 가장 급한 업무부터 응대한다.

온콜 업무를 하다 보면 결국 운영 장애에 대응해야 하는 때가 온다. 온콜 엔지니어는 반드시 장애를 분류하고 완화한 후 해결해야 한다.

온콜 엔지니어는 심각한 알람이 발생하면 호출을 받는다. 예전엔 무선호출기, 요즘은 채팅, 이메일, 전화, 문자 등으로 전달된다.

온콜 교대 업무는 인수인계로 시작하고 끝나야 한다. 온콜 당직 업무의 진행 경과를 잘 기록해 뒀다면 인수인계는 자연스럽게 이뤄진다.

### 반드시 갖춰야 할 온콜 스킬

온콜 업무는 늘 분주하며, 스트레스가 높은 경험이 될 수 있다. 하지만 다행스럽게도 장애와 지원 요청을 모두 처리할 수 있는 기본적인 스킬이 몇가지 있다. 항시 대응할 수 있는 가용성을 먼저 갖추고 장애를 넓은 시야로 볼 수 있어야 한다. 또한 업무의 우선순위를 분류하여 처리할 수 있어야 한다. 명확한 의사소통은 갖춰야 할 기본 요건이다.

#### 항시 언제라도 대응할 준비를 갖추자

"최고의 능력은 가용성"이라는 말은 성공적인 온콜 업무의 핵심이다. 온콜 업무는 요청과 알람에 대응하는 것이다. 언제든 긴급 요청이 발생할 수 있음을 인지하고 그런 만큼 업무에 집중하기 어렵다는 사실을 받아들이자.

온콜 당직에 참여하게 되면 어떤 업무를 수행해야 하는지부터 파악하고, 자신이 대응할 수 없는 상황을 무리하게 처리하려 들지는 말자.

가용성을 갖춘다고 해서 가장 최근의 질문이나 문제를 처리하기 위해 하던 일을 즉시 멈춰야 한다는 뜻은 아니다. 요청이 맣아지면 "지금 다른 사람을 지원 중인데요. 15분 후에 연락 드려도 될까요?"처럼 이미 어떤 일을 처리 중임을 알려주고 언제쯤 자신이 해당 문제를 살펴볼 수 있을지를 예상해서 답변해주면 된다. **사람들은 온콜 엔지니어가 신소갛게 응답하길 원하겠지만 그렇다고 반드시 신속하게 해결할 필요는 없다.**

#### 주의를 늦추지 말고 집중하자

온콜 업무와 관련된 정보는 채팅, 메일, 모니터링 도구, 회의에 이르기까지 다양한 채널을 통해 전달된다. 이런 채널에 주의를 기울여야 디버깅과 트러블슈팅에 필요한 컨텍스트를 얻을 수 있다.

릴리스 노트와 소프트웨어 배포나 설정 변경 같은 운영 관련 정보를 공유하는 채팅 또는 메일은 미리 읽어두자. 회의록도 읽어야 한다. 특히 운영 스크럼 요약본을 읽자.

중요한 대시보드의 링크와 서비스 운영 지침서, 로그에 접근하기 위한 설명서, 주요 채팅방, 트러블슈팅 가이드 등 긴급 상황에서 참조할 수 있는 리소스 목록을 만들어두자. '온콜' 북마크 폴더를 별도로 만들어 지속적으로 관리하면 편하다. 이 목록을 팀과도 공유하자.

#### 업무 우선순위를 정하자

우선순위가 가장 높은 작업부터 시작하자. 업무를 수행하다보면 알람이 울리고 새로운 질문이 들어올 것이다. 이런 방해 요소는 신속하게 분류해서 잠시 보류할지 아니면 긴급 상황으로 간주해 즉시 업무에 착수할지 결정하자.

어떤 요청의 긴급도를 판단하기가 어렵다면 그 요청이 미칠 영향을 한번 생각해보자. 우선순위는 영향도에 의해 결정된다.

만일 어떤 이슈에 대해 자신이 생각하는 우선순위와 요청자가 생각하는 우선순위가 다르다면 여러분의 상사와 상의해보자.

온콜 업무는 P0, P1, P2 등 우선순위로 분류한다. 회사마다 다르겠지만 P0 업무가 가장 중요하다.

**구글 클라우드의 지원 우선순위**
- P1(심각한 영향도): 프로덕션 환경의 서비스가 불가능
- P2(높은 영향도): 서비스의 사용성이 심각하게 저하
- P3(보통 영향도): 서비스의 사용성이 부분적으로 저하
- P4(낮은 영향도): 서비스 사용성에 문제가 없는 상황

#### 명확하게 의사소통하자

명확한 의사소통을 위해서는 공손하고 직접적이며 즉각적이고 철저해야 한다.

운영 업무를 진행하는 중에 방해요소가 계속 발생하면 개발자는 스트레스를 받고 까칠해진다. 사람이라면 어쩔수 없는 일이다. 지원 업무에 응대할 때는 인내심을 갖고 예의를 갖추자.

간결한 문장으로 소통하자. 간결한 표현은 사람들이 읽고 이해하기 쉽다.

모르면 모른다고 솔직히 이야기하자. 답을 알면 목소리를 내자.

요청에는 신속하게 응대하자. 반드시 해결책을 제시할 필요는 없다. 요청자에게 요청이 접수됐음을 알려주고 여러분이 문제를 제대로 이해했는지 확인하자.

주기적으로 상황을 업데이트해주자. 지난 번 업데이트 이후 발견한 사항과 추후 어떵 조치를 취할 계획인지, 그리고 새로운 예상 시간도 제시하자.

#### 업무 진척사항을 추적하자

업무를 진행하면서 경과를 기록해두자. 온콜 업무 동안 수행해야 하는 일은 이슈 트래커나 팀의 온콜(긴급대응) 로그에 기록해야 한다.

동일한 이슈가 다시 발생할 때 앞서 문서로 기록된 해결법을 참고할 수 있다.

그 다음 온콜 엔지니어도 이슈를 읽어보면 진행 중인 업무의 상태를 파악할 수 있으며, 여러분이 누군가에게 도움을 요청할 때 또한 그 사람이 로그를 읽어보고 손쉽게 상황을 파악할 수 있다.

질문과 장애를 로그에 기록해두면 추후에도 누구나 참고할 수 있는 검색 가능한 지식창고를 구축할 수 있다.

슬랙 같은 채팅 채널로 운영 장애와 지원 업무를 소화하는 회사도 있다. 채팅은 의사소통에는 좋은 도구지만 나중에 찾아 읽기가 어려우므로 모든 사항을 티켓이나 문서로 요약해두자.

완료된 이슈는 반드시 완료 상태로 표시해서 온콜 보드를 간결하게 유지하고 온콜 지원 지표가 왜곡되는 일이 없게 하자. 티켓을 완료하기 전에는 요청자에게 해당 이슈가 해결됐는지 확인을 받아야 하고 만약 응답이 없으면 응답이 없으므로 24시간 후에 티켓을 완료하겠다고 알려주고 그렇게 처리하면 된다.

### 장애 처리의 5가지 단계

문제 해결도 중요하지만 심각한 장애 상황에서의 최우선 목표는 문제의 영향을 완화하고 서비스를 복구하는 것이다. 두 번째 목표는 문제가 왜 어떻게 발생했는지 나중에 분석할 수 있도록 정보를 수집하는 것이다. 장애 원인을 파악하고 정확한 지점을 찾아 문제를 해결하는 것은 세 번째 목표이다.

장애 대응은 총 다섯 단계로 구분할 수 있다.

1. 선별triage: 엔지니어는 반드시 문제를 찾아내고 심각도를 파악한 후 누가 수정할지를 결정해야 한다.
2. 조율coordination: 팀 그리고 고객은 반드시 이슈에 대해 전달받아야 한다. 온콜 엔지니어가 스스로 문제를 해결할 수 없다면 해결할 수 있는 사람을 찾아 알려야 한다.
3. 완화mitigation: 엔지니어는 반드시 최대한 빠른 시간 내에 서비스를 안정화해야 한다. 완화는 장기적인 해결책이 아니다. 단순히 서비스를 '지혈'하는 것일 뿐이다. 릴리스를 롤백하거나 다른 환경으로 돌리거나 오동작하는 기능을 끄거나 하드웨어 리소스를 추가하는 등의 방법을 활용해 문제를 완화할 수 있다.
4. 해결resolution: 문제가 완화되면 엔지니어는 숨을 돌리고 해결책에 대해 생각을 가다듬으며 작업할 시간을 벌게 된다. 엔지니어는 문제에 대해 계속 조사하면서 그 원인을 파악하고 해결할 방법을 찾는다. 일단 문제를 찾아 수정하면 장애가 해결된다.
5. 후속 조치follow-up: 애당초 왜 장애가 발생했는지 근본적인 원인에 대한 조사를 수행한다. 심각한 장애의 경우는 포스트모텀이나 회고를 수행한다. 그리고 해당 문제가 다시 발생하지 않도록 후속 조치 업무를 만들어둔다. 팀은 절차나 도구, 문서화에 빈틈이 있는지 다시 한번 확인한다. 장애 대응은 후속 조치를 끝내기 전가지는 완료된 것이 아니다.

_포스트모텀postmoterm이라는 단어는 의료계에서 사용하는 용어로 환자가 사망했을 때 사후 조사를 수행해 그 결과를 기록하던 것에서 유래했다._

_근본 원인 분석(root_case analysis)이라는 용어는 널리 쓰이지만 다소 오해의 소지가 있다. 장애가 단 하나의 이슈로 발생하는 경우는 드물기 때문이다. 실제로 5번의 질문을 하다 보면 여러 가지 다른 원인이 드러날 수도 있다. 설령 그렇더라도 모든 것은 문서화해두자._

### 지원 업무도 엄연한 온콜 업무다

온콜 엔지니어는 장애를 처리하지 않을 때는 지원 요청을 처리한다. 지원 요청은 조직 내의 임직원은 물론 외부 고객이 보낼 수도 있으며 "이건 어떻게 동작하는 거예요?" 같은 질문부터 어려운 트러블슈팅 문제까지 스펙트럼이 넓다. 하지만 대부분의 요청은 버그 보고, 비즈니스 로직에 대한 질문, 소프트웨어 사용에 대한 기술적 질문 등이다.

지원 요청은 상당히 표준화된 흐름을 따른다. 요청을 받으면 요청을 접수했음을 알리고 문제를 제대로 이해했는지 일단 확인한다. 문제를 파악했다면 "오후 5시 내에 다시 연락드리겠습니다." 정도로 대략적인 시간을 포함해서 상황을 업데이트해준다. 그다음, 조사를 시작하고 진척 상황에 따라 요청자에게 상황을 업데이트해주면 된다. 이슈가 해결된 것으로 여겨지면 요청자에게 확인을 부탁하자. 마지막으로 요청을 완료 처리하면 된다.

여러분의 '진짜' 업무는 프로그래밍이기에 지원 업무는 다소 방해 요소처럼 느껴질 수도 있다. 하지만 지원 업무에 대해 배움을 얻을 수 있는 기회로 생각하자. 여러분의 팀이 담당하는 소프트웨어가 실제로 어떻게 사용되는지 그리고 어떤 식으로 실패하거나 사용자에게 혼선을 초래하는지 확인할 수 있는 기회다. 지원 요청에 응대하다 보명 익숙치 않은 코드를 보게 될 수도 있다. 그러면 골똘히 생각하며 이런저런 실험도 해봐야 한다. 어쩌면 문제를 유발하는 패턴을 발견해서 향후에 더 나은 소프트웨어를 작성하는 데 도움이 될 수도 있다. 지원 업무는 여러분을 더 나은 엔지니어로 만들어줄 것이다. 더불어 다른 사람을 돕는 과정에서 타인과의 관계와 여러분에 대한 평판을 쌓을 수 있다. 지원 요청에 신속하고 원활하게 대응한다면 모두가 여러분의 노고를 알아줄 것이다.

#### 영웅이 되려 하지는 말자

온콜이나 지원 업무를 지나치게 많이 하는 것에 대해서도 경고하고 싶다. 온콜 업무를 하다 보면 만족감을 느낄 수 있다. 하지만 온콜 업무를 너무 많이 수행하다 보면 번아웃이 올 수 있다.

여러분이 '영웅'이 되어간다면 더 나은 균형점을 찾고 더 많은 사람을 훈련시켜 투입할 수 있도록 팀장이나 기술 리드와 상의하자. 혹은 팀에 영웅이 있다면 그 사람으로부터 좋은 점은 배우고 그가 짐을 덜 수 있도록 옆에서 도와주자.

<br>

### 생각

현재, 또는 향후 몇년 간의 나와 관련된 부분은 아니라고 생각했다.
특히 게임의 특성상 라이브 서비스거나 결제 관련된 사항이 아니라면 크게 해당이 없다고도 생각한다.
그래도 꽤나 재밌게 읽었다.
게임 업계에서 실제로 온콜 업무를 하는지 궁금하다.