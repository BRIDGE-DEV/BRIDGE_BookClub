## 8장 테스트 전략

> 테스트는 단순히 단위 테스트나 인수 테스트 작성만으로 끝나는 문제가 아니다.

단위 테스트나 인수 테스트 작성은 훌륭한 일이긴 하지만 결코 충분하지 않다.

프로 개발팀이라면 훌륭한 **테스트 전략**이 필요하다.

### QA는 오류를 찾지 못해야 한다

앞 장에서 나온 이야기지만 회사에 QA가 있더라도 개발팀은 QA가 잘못된 점을 찾지 못하는 상태를 목표로 삼아야 한다.

이 이야기는 사실 다른 개발책에서 하는 말과 같은 맥락인 이상적인 목표에 가깝다.

완벽한 코드는 없지만, 완벽한 코드를 추구해야 한다.(프로젝트에 맞는 코드를 추구해야 한다.)

마찬가지로 QA는 무조건 버그를 찾아내겠지만, 개발팀은 QA가 버그를 찾지 못하도록 노력해야 한다.

### QA는 같은 팀이다

QA와 개발자는 시스템 품질 향상을 위해 힘을 합쳐야 한다.

팀원으로서 QA의 가장 중요한 역할은 명세서술과 특징 묘사다.

#### QA의 명세서술

QA의 역할은 사업부와 함께 자동화된 인수 테스트를 만드는 일이다.

그렇게 만든 인수 테스트는 시스템에 대한 진정한 명세서이자 **요구사항 문서**다.

#### QA의 특징 묘사

QA는 탐색 테스트를 수행해 작동 중인 시스템의 실제 동작을 묘사하고 이 동작을 개발팀과 사업부에 보고하는 일이다.

**시스템의 실제 동작을 식별하는 일을 맡는다.**

### 테스트 자동화 피라미드

QA가 오류를 찾지 못하리라는 확신을 가지려면 상위 계층 테스트 또한 필요하다.(컴포넌트)

### 단위 테스트

테스트 자동화 프라미드는 지금 내가 하고 있는 XUnit(유니티는 NUnit) 단위 테스트가 가장 아래에 위치해 있다.

단위테스트는 프로그래머에 의해, 프로그래머를 위해 시스템 프로그래밍 언어로 만든 테스트다.

이 테스트는 시스템 최하위 계층을 명세하려는 의도로 만든다.

테스트 코드는 지속적 통합(CI)의 일부로 실행되어 프로그래머가 의도한 바를 지켜낸다.

단위 테스트의 커버리지는 최대한 100%애 가까워야 한다.

즉, 모든 함수와 모든 분기에 대해 테스트를 작성해야 한다.

### 컴포넌트 테스트

컴포넌트 테스트는 피라미드 아래에서 두번째에 위치한다.

인수테스트의 일종으로 컴포넌트 테스트의 대상은 시스템의 독립 컴포넌트이다.

컴포넌트 테스트는 컴포넌트를 감싸고 있으며, 컴포넌트에 입력 데이터를 넣고 출력 값을 받아 모은다.

입력 값에 대해 출력 값이 올바른지 테스트한다.

유니티에서 이 컴포넌트 테스트는 한 컴포넌트 단위로 이해해도 좋을 듯 하다.

즉, 하나의 MonoBehaviour를 가지고 있는 컴포넌트 C# 클래스를 테스트하는 것이다.

NSubstitute를 이용해 Mocking하여 흉내내는 객체를 만들어서 테스트 더블이 필요한 경우에는 이를 이용하면 된다.

하지만 유니티에선 이런 테스트 더블이 필요한 경우가 많지 않다.

플레이 모드에 대한 테스트가 가능하기 때문에 (실제로 열어서 보면 씬 하나를 만들어서 직접 Play레벨에서 테스트가  가능하다.)

따라서 디바이스에 한정되는 것이 아니라면 테스트를 PlayMode에서 목킹을 만들지 않고 실제 객체로 테스트하는 것이 효율적이라는 것

### 통합 테스트

통합 테스트는 피라미드 아래에서 세번째에 위치한다.

통합 테스트는 여러 컴포넌트로 이뤄진 큰 시스템에서만 의미가 있다.

이 테스트또한 유니티에선 PlayMode에서 UnityTest애트리뷰트로 설정하여 좀 복잡할 수 있지만 컴포넌트끼리의 관계를 설명하기 위한 통합 테스트작성이 가능하다.

### 시스템 테스트

시스템 테스트는 피라미드 아래에서 네번째에 위치한다.

시스템 테스트는 통합한 시스템 전체를 대상으로 하는 자동화 테스트다.

다시 말해 궁극적인 통합 테스트다.

게임에서 이 레벨까지 가능 경우는 보지 못했기 때문에,, 만약 본인이 좋은 회사에 들어간다면 볼지도 모르겠다.

### 수동 탐색 테스트

이 테스트는 피라미드 가장 위에 위치한다.

게임으로 따지면 실제 QA분들이 게임을 플레이하면서 버그를 찾아내는 것이다.

일부러 오류를 찾기 위해 노력하며, 게임에서는 비슷한 형태로 유저에게 이 역할을 맡기기도 한다.(테스트 서버)

### 결론

TDD는 강력한 원칙이며 인수 테스트는 요구사항을 표현하고 강화하는 가치있는 방법이다.

### 느낀점

최근에 계속 테스트 코드를 작성하며 느끼는 점이지만, 테스트 코드는 프로젝트가 장기적일 수록 당연히 중요하지만 개인적 성장에도 매우 큰 도움을 준다는 느낌이다.

TDD는 조금 먼 미래(설계를 제대로 할 줄 알아야 가능)이지만, 단위 테스트 코드는 당장 추천해주고 싶다.

객체지향적으로 코딩하는 새로운 지평이 열리기 때문이다.(실제로 다른 책에서도 언급)

테스트 코드를 항상 생각하고 코드를 짜게 되면 결합도는 낮고 응집도는 높은 코드를 작성하게 된다.

#### 논의사항

- 스스로 작성하신 코드가 테스트 코드가 작성 가능한 레벨인가요? 작성 해보셨나요?

느낀점의 연장이지만, 스스로 테스트 코드작성 가능한 코드를 작성중이신지 궁금합니다.

논외로 한명의 프로그래머로써 테스트 코드의 중요성을 이해하지만 게임업계에서 잘 쓰이는 지는 확신하지 못하겠습니다.

물론 대기업의 경우 쓴다고 100% 생각합니다. (만약 작성하지 않는 다면 다른 방식으로도 테스트코드와 같은 검사체계를 만들어 놨을 것)
